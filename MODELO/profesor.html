<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Panel del Profesor - UNSA</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="panel">
    <h2>Bienvenido al Panel del Profesor</h2>
    <h3 id="nombreProfesor">Profesor: ---</h3>

    <!-- MENÚ PRINCIPAL -->
    <nav class="menu">
      <button onclick="mostrarSeccion('asistencia')">🕒 Registrar asistencia</button>
      <button onclick="mostrarSeccion('horario')">📅 Ver horario</button>
      <button onclick="mostrarSeccion('notas')">📝 Ingresar o editar notas</button>
      <button onclick="mostrarSeccion('reportes')">📊 Reportes de alumnos</button>
      <button onclick="mostrarSeccion('contenido')">📚 Subir y visualizar contenido</button>
      <button onclick="cerrarSesion()">🚪 Cerrar sesión</button>
    </nav>

    <!-- CONTENIDO CAMBIANTE -->
    <div id="contenido"></div>
  </div>

  <script>
    // Al cargar, muestra el nombre del profesor
    document.addEventListener("DOMContentLoaded", () => {
      const profesor = localStorage.getItem("profesorActual");
      if (profesor) {
        document.getElementById("nombreProfesor").innerText = "Profesor: " + profesor;
      }
    });

    // Cambia de sección dinámicamente
    function mostrarSeccion(seccion) {
      const cont = document.getElementById("contenido");

      switch (seccion) {
        // ===== ÉPICA 3: Control de Asistencia =====
        case 'asistencia':
          cont.innerHTML = `
            <h3>Registro de Asistencia (con geolocalización)</h3>
            <p id="ubicacion">Ubicación: ---</p>
            <button onclick="obtenerUbicacion()">Obtener mi ubicación</button>
            <p><strong>Tiempo de clase:</strong> <span id="tiempo">05:00</span></p>
          `;
          iniciarTemporizador(300);
          break;

        // ===== ÉPICA 2: Gestión de Horarios =====
        case 'horario':
          cont.innerHTML = `
            <h3>Mi Horario de Clases</h3>
            <p>Se carga desde <code>horarios.csv</code> según tus cursos.</p>
            <table border="1" style="width:100%; text-align:center;">
              <tr><th>Día</th><th>Curso</th><th>Hora</th><th>Aula</th></tr>
              <tr><td>Lunes</td><td>Programación I</td><td>08:00 - 10:00</td><td>Lab 301</td></tr>
              <tr><td>Miércoles</td><td>Estructura de Datos</td><td>10:00 - 12:00</td><td>Lab 305</td></tr>
            </table>
          `;
          break;

        // ===== ÉPICA 4: Ingreso y Edición de Notas =====
        case 'notas':
          cont.innerHTML = `
            <h3>Ingreso y Edición de Notas</h3>
            <p>Selecciona un curso para ingresar notas:</p>
            <select id="cursoSelect">
              <option>Programación I</option>
              <option>Estructura de Datos</option>
              <option>Base de Datos</option>
            </select>
            <button onclick="abrirNotas()">Ir al registro</button>
          `;
          break;

        // ===== ÉPICA 5: Reportes =====
        case 'reportes':
          cont.innerHTML = `
            <h3>Reportes Académicos</h3>
            <p>Resumen del rendimiento de tus alumnos:</p>
            <ul>
              <li>Programación I - Promedio general: 14.5</li>
              <li>Estructura de Datos - Promedio general: 13.8</li>
              <li>Base de Datos - Promedio general: 15.2</li>
            </ul>
          `;
          break;

        // ===== ÉPICA 5: Gestión del Contenido =====
        case 'contenido':
          cont.innerHTML = `
            <h3>Subir y Visualizar Contenido del Curso</h3>
            <form id="formContenido">
              <label>Seleccionar curso:</label>
              <select id="cursoContenido">
                <option>Programación I</option>
                <option>Estructura de Datos</option>
                <option>Base de Datos</option>
              </select>
              <br><br>
              <label>Seleccionar archivo:</label>
              <input type="file" id="archivoCurso" accept=".pdf,.ppt,.docx,.zip">
              <br><br>
              <button type="submit">Subir contenido</button>
            </form>
          `;
          document.getElementById("formContenido").onsubmit = subirContenido;
          break;
      }
    }

    // ===== FUNCIONES AUXILIARES =====
    function obtenerUbicacion() {
      const ubicacion = document.getElementById("ubicacion");
      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(pos => {
          ubicacion.innerHTML = `Latitud: ${pos.coords.latitude.toFixed(5)}, Longitud: ${pos.coords.longitude.toFixed(5)}`;
        }, () => ubicacion.innerText = "No se pudo obtener la ubicación.");
      } else ubicacion.innerText = "Geolocalización no soportada.";
    }

    function iniciarTemporizador(segundos) {
      const tiempoElem = document.getElementById("tiempo");
      let t = segundos;
      const interval = setInterval(() => {
        const min = Math.floor(t / 60);
        const seg = t % 60;
        tiempoElem.textContent = `${min}:${seg.toString().padStart(2, '0')}`;
        if (t-- <= 0) clearInterval(interval);
      }, 1000);
    }

    function abrirNotas() {
      const curso = document.getElementById("cursoSelect").value;
      localStorage.setItem("cursoSeleccionado", curso);
      window.location.href = "profesor_notas.html";
    }

    function subirContenido(event) {
      event.preventDefault();
      const curso = document.getElementById("cursoContenido").value;
      const archivo = document.getElementById("archivoCurso").files[0];
      if (archivo) {
        alert(`Archivo "${archivo.name}" subido exitosamente para el curso ${curso}.`);
      } else {
        alert("Seleccione un archivo antes de subir.");
      }
    }

    function cerrarSesion() {
      localStorage.removeItem("profesorActual");
      window.location.href = "index.html";
    }
  </script>
</body>
</html>
